<!DOCTYPE html>
<html lang="en" dir="">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link rel="shortcut icon" href="dist-assets/images/logo.png">

    <title>Prototype Property Portal</title>
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css" />
    <link href="https://fonts.googleapis.com/css?family=Nunito:300,400,400i,600,700,800,900" rel="stylesheet" />
    <link href="dist-assets/css/themes/lite-purple.min.css" rel="stylesheet" />
    <link href="dist-assets/css/plugins/perfect-scrollbar.min.css" rel="stylesheet" />
    <!-- <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.0/dist/leaflet.css" />-->
    <link rel="stylesheet" href="css/leaflet.css" />
    <link rel="stylesheet" href="src/leaflet-search.css" />
    <link rel="stylesheet" href="src/style.css" />
    <link rel="stylesheet" href="css/filter.css">
    <link rel="stylesheet" href="css/nouislider.min.css">
    <style>
        html,
        body,
        #map {

            padding: 0;
            margin: 0;

        }

        #cover.active {
            display: block;
        }

        #findbox {
            display: block;
            width: 100%;
            height: calc(2.5rem + 2px);
            padding: 0.375rem 0.75rem;
        }

        .search-tooltip {
            width: 210px;
        }

        .leaflet-control-search .search-cancel {
            position: static;
            float: left;
            margin-left: -22px;
        }

        .leaflet-control-search .search-button {
            /* display: block; */
            float: left;
            width: 0px;
            /* height: 30px; */
            /* background: url(../images/search-icon.png) no-repeat 4px 4px #fff; */
            /* border-radius: 4px; */
        }



        .leaflet-control-search.search-exp {
            background: #fff;
            border: 0px solid rgba(0, 0, 0, 0.2);
            background-clip: padding-box;
            width: 100%;
        }
    </style>
</head>

<body class="text-left">
    <div class="app-admin-wrap layout-horizontal-bar">
        <div class="main-header">
            <div class="logo"><a href="index.html"><img src="dist-assets/images/CDA_4.jpg"
                        style="width: 250px;height: auto; padding : 10px ;" /></a></div>

            <div class="menu-toggle">

            </div>
            <div class="d-flex align-items-center">

            </div>
            <div style="margin: auto"></div>
            <div class="header-part-right">

                <!-- User avatar dropdown-->
                <div class="dropdown">
                    <div class="user col align-self-end"><img id="userDropdown" src="dist-assets/images/faces/shams.jpg"
                            alt="" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" />
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="userDropdown">
                            <div class="dropdown-header"><i class="i-Lock-User mr-1"></i> Shareef</div><a
                                class="dropdown-item">Account settings</a><a class="dropdown-item">Billing history</a><a
                                class="dropdown-item" href="signin.html">Sign out</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- header top menu end-->

        <!-- =============== Horizontal bar End ================-->
        <div class="main-content-wrap d-flex flex-column">
            <!-- ============ Body content start ============= -->
            <div class="main-content">
                <div class="row">
                    <div class="col-md-2">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="card mb-12">
                                    <div class="card-body">
                                        <div class="card-title mb-3">Find a property:</div>

                                        <form>
                                            <!-- Subsector Search -->
                                            <label for="subsector">Sub Sector:</label>
                                            <select name="subsector" id="subsector" style="width: 100%;">
                                                <option value="x">Select Subsector</option>
                                                <option value="Subsector 1">Subsector 1</option>
                                                <option value="Subsector 2">Subsector 2</option>
                                                <option value="Subsector 3">Subsector 3</option>
                                                <option value="Subsector 4">Subsector 4</option>
                                            </select>
                                            <!-- Street  Search -->
                                            <br>
                                            <label for="street">Street:</label> <br>
                                            <select name="street" id="street" style="width: 100%;">
                                            </select>

                                            <!-- Plot Search -->
                                            <label for="plot" style="margin-bottom: 0%;">Plot: </label>
                                            <div id="plot"></div>

                                            <div class="row">
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-10">
                        <div id="map">
                            <div class="leaflet-control">
                                <div class="drop-shadow"
                                    style="width: 218px; height: 250px; background-color: rgb(255, 255, 255); align-items: center; padding: 10px; border-radius: 10px; opacity: 0.8;">
                                    <div class="ontop" style="margin-top: 5px;">
                                        <div class="ontop"
                                            style="width: 12px; height: 12px; display: inline-block; background-color: rgb(0, 112, 192); left: 5px; top: 4px; margin-right: 10px; border-radius: 3px; opacity: 1; margin-bottom: 2px;">
                                        </div><span class="ontop"
                                            style="font-size: 13px; font-weight: 400; margin-top: 5px;">Commercial</span>
                                    </div>
                                    <div class="ontop" style="margin-top: 5px;">
                                        <div class="ontop"
                                            style="width: 12px; height: 12px; display: inline-block; background-color: rgb(184, 92, 0); left: 5px; top: 4px; margin-right: 10px; border-radius: 3px; opacity: 1; margin-bottom: 2px;">
                                        </div><span class="ontop"
                                            style="font-size: 13px; font-weight: 400; margin-top: 5px;">Residential</span>
                                    </div>
                                    <div class="ontop" style="margin-top: 5px;">
                                        <div class="ontop"
                                            style="width: 12px; height: 12px; display: inline-block; background-color: rgb(46, 204, 113); left: 5px; top: 4px; margin-right: 10px; border-radius: 3px; opacity: 1; margin-bottom: 2px;">
                                        </div><span class="ontop"
                                            style="font-size: 13px; font-weight: 400; margin-top: 5px;">Recreational
                                            Place</span>
                                    </div>
                                    <div class="ontop" style="margin-top: 5px;">
                                        <div class="ontop"
                                            style="width: 12px; height: 12px; display: inline-block; background-color: rgb(17, 237, 75); left: 5px; top: 4px; margin-right: 10px; border-radius: 3px; opacity: 1; margin-bottom: 2px;">
                                        </div><span class="ontop"
                                            style="font-size: 13px; font-weight: 400; margin-top: 5px;">Open Spaces
                                            &amp; Parks</span>
                                    </div>
                                    <div class="ontop" style="margin-top: 5px;">
                                        <div class="ontop"
                                            style="width: 12px; height: 12px; display: inline-block; background-color: rgb(255, 255, 0); left: 5px; top: 4px; margin-right: 10px; border-radius: 3px; opacity: 1; margin-bottom: 2px;">
                                        </div><span class="ontop"
                                            style="font-size: 13px; font-weight: 400; margin-top: 5px;">Institutes &amp;
                                            Public Building</span>
                                    </div>
                                    <div class="ontop" style="margin-top: 5px;">
                                        <div class="ontop"
                                            style="width: 12px; height: 12px; display: inline-flex; background-color: rgb(255, 255, 255); left: 5px; top: 4px; margin-right: 10px; border-radius: 3px; border: 1px solid red; opacity: 1; margin-bottom: 2px;">
                                        </div><span class="ontop"
                                            style="font-size: 13px; font-weight: 400; margin-top: 5px;">Mosque &amp;
                                            Religious Building</span>
                                    </div>
                                    <div class="ontop" style="margin-top: 5px;">
                                        <div class="ontop"
                                            style="width: 12px; height: 12px; display: inline-block; background-color: rgb(255, 201, 202); left: 5px; top: 4px; margin-right: 10px; border-radius: 3px; opacity: 1; margin-bottom: 2px;">
                                        </div><span class="ontop"
                                            style="font-size: 13px; font-weight: 400; margin-top: 5px;">Hospitals &amp;
                                            Health Institutes</span>
                                    </div>
                                    <div class="ontop" style="margin-top: 5px;">
                                        <div class="ontop"
                                            style="width: 12px; height: 12px; display: inline-block; background-color: rgb(166, 172, 175); left: 5px; top: 4px; margin-right: 10px; border-radius: 3px; opacity: 1; margin-bottom: 2px;">
                                        </div><span class="ontop"
                                            style="font-size: 13px; font-weight: 400; margin-top: 5px;">Parkings</span>
                                    </div>
                                    <div class="ontop" style="margin-top: 5px;">
                                        <div class="ontop"
                                            style="width: 12px; height: 12px; display: inline-block; background-color: rgb(255,0,0); left: 5px; top: 4px; margin-right: 10px; border-radius: 3px; opacity: 1; margin-bottom: 2px;">
                                        </div><span class="ontop"
                                            style="font-size: 13px; font-weight: 400; margin-top: 5px;">Housing Scheme
                                            Boundry</span>
                                    </div>
                                    <div class="ontop" style="margin-top: 5px;">
                                        <div class="ontop"
                                            style="width: 12px; height: 12px; display: inline-block; background-color: rgb(255,165,0); left: 5px; top: 4px; margin-right: 10px; border-radius: 3px; opacity: 1; margin-bottom: 2px;">
                                        </div><span class="ontop"
                                            style="font-size: 13px; font-weight: 400; margin-top: 5px;">Sub Sector
                                            Boundry</span>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>



                <!-- end of main-content -->
            </div><!-- Footer Start -->
            <div class="flex-grow-1"></div>
            <div class="app-footer">
                <div class="row">
                    <div class="col-md-9">
                        <p><strong></strong></p>

                    </div>
                </div>
                <div class="footer-bottom border-top pt-3 d-flex flex-column flex-sm-row align-items-center">
                    <span class="flex-grow-1"></span>
                    <div class="d-flex align-items-center">
                        <img class="logo" src="" style="width: 60px;height: auto;padding: 10px;">
                        <div>
                            <p class="m-0">&copy; </p>
                            <p class="m-0"></p>
                        </div>
                    </div>
                </div>
            </div>
            <!-- fotter end -->
        </div>
    </div><!-- ============ Search UI Start ============= -->


</body>

</html>
<script src="https://unpkg.com/leaflet@1.3.0/dist/leaflet.js"></script>
<script src="src/leaflet-search.js"></script>

<script src="js/leaflet.rotatedMarker.js"></script>
<script src="js/leaflet.pattern.js"></script>
<script src="js/leaflet-hash.js"></script>
<script src="js/Autolinker.min.js"></script>
<script src="js/rbush.min.js"></script>
<script src="js/labelgun.min.js"></script>
<script src="js/labels.js"></script>
<script src="js/tailDT.js"></script>
<script src="js/nouislider.min.js"></script>
<script src="js/wNumb.js"></script>

<script src="data/AreaClass_1.js"></script>
<script src="data/abc.js"></script>
<script src="data/Boundry_1.js"></script>

<script>

    var shopsData = abc;
    var map = L.map('map', {
        zoomControl: false, maxZoom: 20, minZoom: 12

    }).fitBounds([[33.72448243554521, 73.06560516357422], [33.73547530473849, 73.0949592590332]]);
    map.addLayer(new L.TileLayer('https://mt1.google.com/vt/lyrs=y&x={x}&y={y}&z={z}'));	//base layer
    var bounds_group = new L.featureGroup([]);
    function setBounds() {
    }

    //Plot detail 
    function style_shopsDetail(feature) {
        switch (String(feature.properties['land_use'])) {
            case 'Commercial':
                return {
                    pane: 'pane_abc',
                    opacity: 1,
                    color: 'rgba(35,35,35,1.0)',
                    dashArray: '',
                    lineCap: 'butt',
                    lineJoin: 'miter',
                    weight: 1.0,
                    fill: true,
                    fillOpacity: 0.5,
                    fillColor: 'rgba(0, 112, 192,1.0)',
                    interactive: true,
                }

                break;
            case 'Hospitals & Health Facilities':
                return {
                    pane: 'pane_abc',
                    opacity: 1,
                    color: 'rgba(35,35,35,1.0)',
                    dashArray: '',
                    lineCap: 'butt',
                    lineJoin: 'miter',
                    weight: 1.0,
                    fill: true,
                    fillOpacity: 0.5,
                    fillColor: 'rgba(255, 201, 202,1.0)',
                    interactive: true,
                }
                break;
            case 'Institutes':
                return {
                    pane: 'pane_abc',
                    opacity: 1,
                    color: 'rgba(35,35,35,1.0)',
                    dashArray: '',
                    lineCap: 'butt',
                    lineJoin: 'miter',
                    weight: 1.0,
                    fill: true,
                    fillOpacity: 0.5,
                    fillColor: 'rgba(255, 255, 0,1.0)',
                    interactive: true,
                }
                break;
            case 'Mosque & Religious Building':
                return {
                    pane: 'pane_abc',
                    opacity: 1,
                    color: 'rgba(255,0,0,1.0)',
                    dashArray: '',
                    lineCap: 'butt',
                    lineJoin: 'miter',
                    weight: 1.0,
                    fill: true,
                    fillOpacity: 0.5,
                    fillColor: 'rgba(255, 255, 255,1.0)',
                    interactive: true,

                }
                break;
            case 'Open Spaces & Park':
                return {
                    pane: 'pane_abc',
                    opacity: 1,
                    color: 'rgba(35,35,35,1.0)',
                    dashArray: '',
                    lineCap: 'butt',
                    lineJoin: 'miter',
                    weight: 1.0,
                    fill: true,
                    fillOpacity: 0.5,
                    fillColor: 'rgba(17, 237, 75,1.0)',
                    interactive: true,
                }
                break;
            case 'Public Building':
                return {
                    pane: 'pane_abc',
                    opacity: 1,
                    color: 'rgba(35,35,35,1.0)',
                    dashArray: '',
                    lineCap: 'butt',
                    lineJoin: 'miter',
                    weight: 1.0,
                    fill: true,
                    fillOpacity: 0.5,
                    fillColor: 'rgba(255, 255, 0,1.0)',
                    interactive: true,
                }
                break;
            case 'Recreational':
                return {
                    pane: 'pane_abc',
                    opacity: 1,
                    color: 'rgba(35,35,35,1.0)',
                    dashArray: '',
                    lineCap: 'butt',
                    lineJoin: 'miter',
                    weight: 1.0,
                    fill: true,
                    fillOpacity: 0.5,
                    fillColor: 'rgba(46, 204, 113,1.0)',
                    interactive: true,
                }
                break;
            case 'Residential':
                return {
                    pane: 'pane_abc',
                    opacity: 1,
                    color: 'rgba(35,35,35,1.0)',
                    dashArray: '',
                    lineCap: 'butt',
                    lineJoin: 'miter',
                    weight: 1.0,
                    fill: true,
                    fillOpacity: 0.5,
                    fillColor: 'rgba(184, 92, 0,1.0)',
                    interactive: true,
                }
                break;
            case 'Residential cum Commercial':
                return {
                    pane: 'pane_abc',
                    opacity: 1,
                    color: 'rgba(35,35,35,1.0)',
                    dashArray: '',
                    lineCap: 'butt',
                    lineJoin: 'miter',
                    weight: 1.0,
                    fill: true,
                    fillOpacity: 0.5,
                    fillColor: 'rgba(122,211,58,1.0)',
                    interactive: true,
                }
                break;
            case 'Other':
                return {
                    pane: 'pane_abc',
                    opacity: 1,
                    color: 'rgba(35,35,35,1.0)',
                    dashArray: '',
                    lineCap: 'butt',
                    lineJoin: 'miter',
                    weight: 1.0,
                    fill: true,
                    fillOpacity: 0.5,
                    fillColor: 'rgba(166, 172, 175,1.0)',
                    interactive: true,
                }
                break;
        }
    }
    map.createPane('pane_abc');
    map.getPane('pane_abc').style.zIndex = 402;
    map.getPane('pane_abc').style['mix-blend-mode'] = 'normal';

    var shopsDetailLayer = new L.GeoJSON(shopsData, {


        dataVar: 'abc',
        layerName: 'shopsDetailLayer',
        style: style_shopsDetail,
        onEachFeature: function (feature, marker) {
            marker.bindPopup('<h4>' + feature.properties.File_No + '</h4><table>\<tr>\<th scope="row">Plot No</th>\<td>' + feature.properties.plot_no + '</td>\</tr>\<tr>\<th scope="row">Street No</th>\<td>' + feature.properties.street + '</td>\</tr>\<tr>\<th scope="row">Sub Sector</th>\<td>' + feature.properties.phase_sector_name + '</td>\</tr>\<tr>\<th scope="row">Sector</th>\<td>' + feature.properties.housing_scheme_name + '</td>\</tr>\<tr>\<th scope="row">Plot Size</th>\<td>' + feature.properties.Plot_Size + '</td>\</tr>\<tr>\<th scope="row">Plot Type</th>\<td>' + feature.properties.Plot_Type_1 + '</td>\</tr>\<tr>\<th scope="row">Current Allottee Name</th>\<td>' + feature.properties.Name + '</td>\</tr>\<tr>\<th scope="row">S/O, D/O, W/O</th>\<td>' + feature.properties.SODOWO + '</td>\</tr>\<tr>\<th scope="row">CNIC</th>\<td>' + feature.properties.CNIC + '</td>\</tr>\<tr>\<th scope="row">Address</th>\<td>' + feature.properties.Address + '</td>\</tr>\<tr>\<th scope="row">Date of Transfer</th>\<td>' + feature.properties.Transfer + '</td>\</tr>\<tr>\</tr>\<tr>\</tr>\<tr>\</tr>\<tr>\</tr>\<tr>\</tr>\</table><a href="report/CDA-EM- G-6- (SR) 91-62.pdf" type="button" style="width:100%" class="btn btn-primary">Generate Title Register Report</a><a href="report/TP__CDA-EM-G-6-1-1 (48) 16-74.pdf" type="button" style="width:100%" class="btn btn-primary">Generate Title Plan Report</a>');

        }
    });

    bounds_group.addLayer(shopsDetailLayer)
    map.addLayer(shopsDetailLayer);



    //Block Boundry Layer
    var json_AreaClass_1 = AreaClass_1;
    function style_AreaClass_1_0() {
        return {
            pane: 'pane_AreaClass_1',
            opacity: 1,
            color: 'rgba(255,165,0,1.0)',
            dashArray: '',
            lineCap: 'butt',
            lineJoin: 'miter',
            weight: 4.0,
            fillOpacity: 0,
            interactive: false,
        }
    }
    map.createPane('pane_AreaClass_1');
    map.getPane('pane_AreaClass_1').style.zIndex = 401;
    map.getPane('pane_AreaClass_1').style['mix-blend-mode'] = 'normal';
    var layer_AreaClass_1 = new L.geoJson(json_AreaClass_1, {
        style: style_AreaClass_1_0,
    });
    bounds_group.addLayer(layer_AreaClass_1);
    map.addLayer(layer_AreaClass_1);
    // End Boundry Layer

    // Housing Scheme Boudry Layer
    var Boundry = Boundry_1;
    function style_Boundry_1_0() {
        return {
            pane: 'pane_Boundry_1',
            opacity: 1,
            color: 'rgba(255,0,0,1.0)',
            dashArray: '',
            lineCap: 'butt',
            lineJoin: 'miter',
            weight: 4.0,
            fillOpacity: 0,
            interactive: false,
        }
    }
    map.createPane('pane_Boundry_1');
    map.getPane('pane_Boundry_1').style.zIndex = 403;
    map.getPane('pane_Boundry_1').style['mix-blend-mode'] = 'normal';
    var layer_Boundry_1 = new L.geoJson(Boundry, {
        style: style_Boundry_1_0,

    });
    bounds_group.addLayer(layer_Boundry_1);
    map.addLayer(layer_Boundry_1);
    // End Housing Scheme Boundry
    // Point Layer Start

    // End Point Layer 

    //Search Control Starts Here

    const distinct = (value, index, self) => {
        return self.indexOf(value) === index;
    }

    document.getElementById("subsector").onchange = function () {

        dynamicoptionsstreet(document.getElementById("subsector").value)
    };

    document.getElementById("street").onchange = function () {

        dynamicoptionsPlot(document.getElementById("street").value)
    };

    function dynamicoptionsstreet(selectedvalue) {
        // let selectedvalue = document.getElementById('findbox2').value;
        console.log(selectedvalue)

        let options;
        let arr = [];
        for (let i = 0; i < shopsData.features.length; i++) {

            if (shopsData.features[i].properties.phase_sector_name == selectedvalue) {

                arr.push(shopsData.features[i].properties.street)
                // options += '<option value = "">' + shopsData.features[i].properties.street + '</option>'
            }

        }

        distinctItems = arr.filter(distinct)
        console.log(distinctItems)

        for (let i = 0; i < distinctItems.length; i++) {

            options += '<option value = "' + distinctItems[i] + '">' + distinctItems[i] + '</option>'

        }

        document.getElementById('street').innerHTML = options
    }

    function dynamicoptionsPlot(selectedvalue) {
        let geoJson = {
            type: "FeatureCollection",
            features: []
        }
        // let selectedvalue = document.getElementById('findbox2').value;
        // console.log(map.hasCustomControl(searchControl3))

        let options;
        // let arr = [];
        for (let i = 0; i < shopsData.features.length; i++) {

            if (shopsData.features[i].properties.street == selectedvalue) {

                geoJson.features.push(shopsData.features[i])

            }

        }

        console.log(geoJson)

        var geojsonlayer = new L.GeoJSON(geoJson, {


            dataVar: 'abc',
            layerName: 'geojsonlayer',
            style: style_shopsDetail,
            onEachFeature: function (feature, marker) {
                marker.bindPopup('<h4>' + feature.properties.File_No + '</h4><table>\<tr>\<th scope="row">Plot No</th>\<td>' + feature.properties.plot_no + '</td>\</tr>\<tr>\<th scope="row">Street No</th>\<td>' + feature.properties.street + '</td>\</tr>\<tr>\<th scope="row">Sub Sector</th>\<td>' + feature.properties.phase_sector_name + '</td>\</tr>\<tr>\<th scope="row">Sector</th>\<td>' + feature.properties.housing_scheme_name + '</td>\</tr>\<tr>\<th scope="row">Plot Size</th>\<td>' + feature.properties.Plot_Size + '</td>\</tr>\<tr>\<th scope="row">Plot Type</th>\<td>' + feature.properties.Plot_Type_1 + '</td>\</tr>\<tr>\<th scope="row">Current Allottee Name</th>\<td>' + feature.properties.Name + '</td>\</tr>\<tr>\<th scope="row">S/O, D/O, W/O</th>\<td>' + feature.properties.SODOWO + '</td>\</tr>\<tr>\<th scope="row">CNIC</th>\<td>' + feature.properties.CNIC + '</td>\</tr>\<tr>\<th scope="row">Address</th>\<td>' + feature.properties.Address + '</td>\</tr>\<tr>\<td>' + feature.properties.Allotment + '</td>\</tr>\<tr>\</tr>\<tr>\</tr>\<tr>\</tr>\<tr>\</tr>\</table><a href="../report/' + feature.properties.File_No + '.pdf" type="button" style="width:100%" class="btn btn-primary">Generate Title Register Report</a><a href="../report/TP__' + feature.properties.File_No + '.pdf" type="button" style="width:100%" class="btn btn-primary">Generate Title Plan Report</a>');

            }
        })

        var searchControl3 = new L.Control.Search({
            container: 'plot',
            initial: false,
            collapsed: false,

            layer: geojsonlayer,
            propertyName: 'plot_no',
            marker: false,
            moveToLocation: function (latlng, title, map) {

                var zoom = map.getBoundsZoom(latlng.layer.getBounds());
                map.setView(latlng, zoom); // access the zoom
            }
        });

        searchControl3.on('search:locationfound', function (e) {
            e.layer.setStyle({
                weight: 5,
                opacity: 1,
                color: 'red',  //Outline color
                fillOpacity: 0.0
            });

            if (e.layer._popup) {

                e.layer.openPopup();
            }

        })
        map.removeControl(searchControl3)
        map.addControl(searchControl3);


    }


    // Search Control Ends here


    // Layer on and Off 
    var baseMaps = { 'Layer Control': map };
    controler = L.control.layers(baseMaps, { "Housing Scheme Boundry": layer_Boundry_1, "Block Boundry": layer_AreaClass_1, "Plots": shopsDetailLayer }, { collapsed: false }).addTo(map)
    // End Layer on and Off

    //Start of Filter 
    /// End of Filter


</script>

</body>

</html>